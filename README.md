# win32exploits
#### Millennium MP3 Studio 2.0
https://www.exploit-db.com/apps/3c35dc3d6067fcc50f118500eb116c0b-millennium1.exe

This is a new take on a simple windows SEH (structured exception handling) BOF (buffer overflow) exploit. Multiple examples of the original BOF exploit can be found on www.exploit-db.com and searching for "millenium".  Exploiting the Millennium MP3 Studio app requires the user to open the exploit file locally on the machine - this is not a remote attack.

Windows Security - App & browser control - Exploit protection settings on modern Windows versions is enabled by default.  Part of this protection suite is Data Execution Prevention (DEP) which prevents stack execution which is needed for a traditional (historical) BOF (buffer overflow) attack.  This exploit defeats DEP using ROP (return oriented programming) to call VirtualAlloc to turn off DEP on the stack. The entry into EIP control is Windows SEH.  Because of DEP a typical 'pop pop ret' gadget cannnot be used to hijack control flow.  Instead a stack pivot gadget is used for the SEH address overwrite to enter the ROP chain that sets up and calls the VirtualAlloc Kernel32 function and returns to the shellcode loaded on the stack.  

One other protection that Windows Security enables by default is Real-time protection.  This protection will (usually) catch reverse shell exploits like this but not until after the connection has been made.  In developing this exploit I had mixed results with this protection.  Sometimes it triggered and sometimes it didn't.  I mention it here to make the user aware - the exploit does not attempt to defeat this protection.

This exploit is for educational purposes only.  This is a good exploit to work through to understand how to turn a SEH exploit into a modern ROP exploit that defeats DEP.  The ROP chain was painstakingly created manually with rp++, grep, and WinDBG to guide the process.

